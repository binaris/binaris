- test: Test js input
  steps:
    -   in: bn create node8 returnInput
    -   in: |-
            echo 'exports.handler = (input) => ({ inputType: typeof input, input});' >function.js
    -   in: bn deploy returnInput
    -   in: curl -s "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnInput"
        out: '{"inputType":"object","input":{}}'
    -   in: curl -s --data '{"' "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnInput"
        out: '{"inputType":"undefined"}'
    -   in: curl -s --data '{}' "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnInput"
        out: '{"inputType":"object","input":{}}'
    -   in: curl -s --data '{"foo":"bar","yet":123}' "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnInput"
        out: '{"inputType":"object","input":{"foo":"bar","yet":123}}'
    -   in: curl -s --data '["foo","bar"]' "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnInput"
        out: '{"inputType":"object","input":["foo","bar"]}'
    -   in: bn remove returnInput
- test: Test js method 
  steps:
    -   in: bn create node8 returnMethod
    -   in: |-
            echo 'exports.handler = (_, req) => req.method;' >function.js
    -   in: bn deploy returnMethod
    -   in: curl -s -X GET "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnMethod"
        out: '"GET"'
    -   in: curl -s -X POST "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnMethod"
        out: '"POST"'
    -   in: curl -s -X PUT "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnMethod"
        out: '"PUT"'
    -   in: curl -s -X DELETE "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnMethod"
        out: '"DELETE"'
    -   in: curl -s -X OPTIONS "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnMethod"
        out: '"OPTIONS"'
    -   in: curl -s -X PATCH "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnMethod"
        out: '"PATCH"'
    -   in: bn remove returnMethod
- test: Test js data input
  steps:
    -   in: bn create node8 returnReqBody
    -   in: |-
            echo 'exports.handler = (_, req) => req.body;' >function.js
    -   in: bn deploy returnReqBody
    -   in: curl -s "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqBody"
        out: '{"type":"Buffer","data":[]}'
    -   in: curl -s --data '{' "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqBody"
        out: '{"type":"Buffer","data":[123]}'
    -   in: curl -s --data '{}' "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqBody"
        out: '{"type":"Buffer","data":[123,125]}'
    -   in: curl -s --data ' ' "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqBody"
        out: '{"type":"Buffer","data":[32]}'
    -   in: curl -s --data-urlencode ' ' "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqBody"
        out: '{"type":"Buffer","data":[37,50,48]}'
    -   in: echo | curl -s --data-binary @- "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqBody"
        out: '{"type":"Buffer","data":[10]}'
    -   in: echo | gzip -n | curl -s --data-binary @- "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqBody"
        out: '{"type":"Buffer","data":[31,139,8,0,0,0,0,0,0,3,227,2,0,147,6,215,50,1,0,0,0]}'
    -   in: bn remove returnReqBody
- test: Test js headers input
  steps:
    -   in: bn create node8 returnReqTestHeader
    -   in: |-
            echo 'exports.handler = (_, req) => req.headers.test;' >function.js
    -   in: bn deploy returnReqTestHeader
    -   in: curl -s "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqTestHeader"
        out: ''
    -   in: |-
            curl -s -H "Test;" "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqTestHeader"
        out: '""'
    -   in: |-
            curl -s -H "Test: foo" "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqTestHeader"
        out: '"foo"'
    -   in: |-
            curl -s -H "Test: 123" "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqTestHeader"
        out: '"123"'
    -   in: |-
            curl -s -H "Test: foo" -H "Test: bar" "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqTestHeader"
        out: '"foo, bar"'
    -   in: bn remove returnReqTestHeader
- test: Test js query input
  steps:
    -   in: bn create node8 returnReqQuery
    -   in: |-
            echo 'exports.handler = (_, req) => req.query;' >function.js
    -   in: bn deploy returnReqQuery
    -   in: curl -s "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqQuery"
        out: '{}'
    -   in: curl -s "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqQuery?foo=123"
        out: '{"foo":"123"}'
    -   in: curl -s "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqQuery?foo=123&bar=this"
        out: '{"foo":"123","bar":"this"}'
    -   in: curl -s "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqQuery?foo="
        out: '{"foo":""}'
    -   in: curl -s "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqQuery/some/where?foo=123"
        out: '{"foo":"123"}'
    -   in: curl -s "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqQuery/some/where?foo=123&bar=this"
        out: '{"foo":"123","bar":"this"}'
    -   in: curl -s "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqQuery?foo="
        out: '{"foo":""}'
    -   in: bn remove returnReqQuery
- test: Test js path input
  steps:
    -   in: bn create node8 returnReqPath
    -   in: |-
            echo 'exports.handler = (_, req) => req.path;' >function.js
    -   in: bn deploy returnReqPath
    -   in: curl -s "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqPath"
        out: '"/"'
    -   in: curl -s "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqPath/////"
        out: '"/"'
    -   in: curl -s "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqPath/foo"
        out: '"/foo"'
    -   in: curl -s "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqPath/foo?qs"
        out: '"/foo"'
    -   in: curl -s "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqPath/foo/"
        out: '"/foo/"'
    -   in: curl -s "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqPath/foo/?qs=1"
        out: '"/foo/"'
    -   in: curl -s "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqPath/foo///"
        out: '"/foo/"'
    -   in: curl -s "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqPath/foo/bar"
        out: '"/foo/bar"'
    -   in: curl -s "https://${BINARIS_INVOKE_ENDPOINT}/v1/run/${BINARIS_API_KEY}/returnReqPath/foo/bar/"
        out: '"/foo/bar/"'
    -   in: bn remove returnReqPath
